@model XoneHR.Models.CandidateDetails
@{
    ViewBag.Title = "CandidateAppoinmentletter";
    var EmpDetail = ViewBag.Empdetails;
}


<script src="~/plugins/Toast/src/jquery.toast.js"></script>
<link href="~/plugins/Toast/src/jquery.toast.css" rel="stylesheet" /> 

<script src="~/plugins/jQuery/print.js"></script>

<script type="text/javascript">


    $(document).ready(function () {

        GetEmptype();
              
        $("#btnAddAppoinment").click(function () {
            $.validator.addMethod("check_item_dropdown", function (value, element) {
                return this.optional(element) || value != 0;
            }, "Please select an item from the dropdown list.");
            //$("#AppoinmentFormID").validate({
            //    rules: {
            //        StartDate: {
            //            required: true,
            //            //date: true
            //        },
            //        Employeetyp: {
            //            required: true,
            //            check_item_dropdown: true
            //        },
            //        BasicSalary: {
            //            required: true,
            //            number: true
            //        }
            //    }
            //});

           // if ($("#AppoinmentFormID").valid()) {

                //$.ajax({

                //    type: "POST",
                //    url: "/Candidate/AddNewEmployee",
                //    data: $("#AppoinmentFormID").serialize()

                //}).done(function (data) {

                //    if (data) {
                //        $.toast({
                //            text: "Saved Successfully",
                //            position: 'top-right',
                //            hideAfter: 3000,
                //            showHideTransition: 'slide',
                //            loader: false,
                //        })                       
                //        var HTMLContent = $("#AppoinmentFormID").html(); 
                //        $.ajax({

                //            url: "/Candidate/CandAppoinmnetLetterPDF",
                //            type: "POST",
                //            cache: false,
                //            data: JSON.stringify({ lettercontent: HTMLContent, CandId: $("#HidCandids").val() }),
                //            dataType: 'json',
                //            contentType: "application/json; charset=utf-8",
                //            success: function (msg) {                               
                //                $("#PrintDiv").print({
                //                    globalStyles: true,
                //                    mediaPrint: true,
                //                    stylesheet: null,
                //                    noPrintSelector: ".no-print",
                //                    iframe: true,
                //                    append: null,
                //                    prepend: null,
                //                    manuallyCopyFormValues: true,
                //                    deferred: $.Deferred(),
                //                    timeout: 250,
                //                    title: null,
                //                    doctype: '<!doctype html>'
                //                });
                //            },
                //        });                        
                //    }
                //    else {
                //        $.toast({

                //            text: "Application Error Please Contact Administrator!",
                //            position: 'top-right',
                //            hideAfter: 3000,
                //            showHideTransition: 'slide',
                //            loader: false,
                //        })
                //    }

                //})
               
            //}

            $.ajax({
                type:"GET",
                url: "/Candidate/UpdateCandidateStatus",
                data:{ CandID:$("#HidCandids").val() }
            }).done(function (data) {
                $.toast({
                    text: data.Message,
                    position: 'top-right',
                    hideAfter: 3000,
                    showHideTransition: 'slide',
                    loader: false,
                })

                if (data.Result == 1)
                    window.location.href = "/Candidate/Index";
            });

        });

        $('#EmpTypID').change(function () {
            if ($(this).val() != 0) {
                $("label[for='EmpTypID']").text('');
            }
            else {
                $("label[for='EmpTypID']").text('Please select an item from the dropdown list.');
            }

        })
        $('#StartDate').change(function () {
            $(this).blur();
        })

        $("#div_funds").hide();
        $("#div_levy").hide();
        if ($("#CizenID").val() == 2)
        {
            GetFundTypes();
            $("#div_funds").show();
            $("#div_levy").hide();
        }
        else
        {
            $("#div_funds").hide();
            $("#div_levy").show();
        }

        $("#PrintApponmentLetter").click(function () {
            //$.validator.addMethod("check_item_dropdown", function (value, element) {
            //    return this.optional(element) || value != 0;
            //}, "Please select an item from the dropdown list.");
            //$("#AppoinmentFormID").validate({
            //    rules: {
            //        StartDate: {
            //            required: true,
            //           // date: true
            //        },
            //        Employeetyp: {
            //            required: true,
            //            check_item_dropdown: true
            //        },
            //        BasicSalary: {
            //            required: true,
            //            number: true
            //        }
            //    }
            //});

            $("#PrintDiv").print({
                globalStyles: true,
                mediaPrint: true,
                stylesheet: null,
                noPrintSelector: ".no-print",
                iframe: true,
                append: null,
                prepend: null,
                manuallyCopyFormValues: true,
                deferred: $.Deferred(),
                timeout: 250,
                title: null,
                doctype: '<!doctype html>'

            });

        })

        $("#EmpEndDateDiv").hide();
        $("#BSal_PermanentEmp").hide();
        $("#EmpTypID").change(function () {

            if ($("#EmpTypID").val() == 1)
            {
                $("#EmpEndDateDiv").hide();  //If permanent employee   
                $("#DivPartemp").hide();
                $("#BSal").show();
                $("#BSal_PermanentEmp").hide();
            }
            else if ($(this).val() == 2) {
                $("#DivPartemp").show();
                $("#EmpEndDateDiv").hide();
                //$("#BSal").hide();               
            }
            else
            {
                $("#EmpEndDateDiv").show();
                $("#DivPartemp").hide();
                $("#BSal").show();
                $("#BSal_PermanentEmp").hide();
            }
        });

        $(".rd_PayStruct").change(function () {

            if ($("#rd_PayStruct1").is(':checked') == 1) { 
                $("#BSal_PermanentEmp").html("Hourly Base Salary");
                $("#BSal_PermanentEmp").show();
                $("#BSal").hide();
            }
            else if ($("#rd_PayStruct2").is(':checked') == 1) {
                $("#BSal").hide();
                $("#BSal_PermanentEmp").html("");
                $("#BSal_PermanentEmp").html("Daily Base Salary");
                $("#BSal_PermanentEmp").show();
            }
            else {
                $("#BSal_PermanentEmp").hide();
                $("#BSal").show();
            }
        });

    });

</script>

<script type="text/javascript">

    function GetEmptype() {

        var ddlBox = $("#EmpTypID");
        $.ajax({
            url: "/Candidate/GetEmployeeType",

        }).done(function (data) {

            ddlBox.empty();
            ddlBox.append('<option value="0">--Select--</option>').selectpicker('refresh');

            $.each(data, function (i, item) {

                ddlBox.append('<option value=' + item.EmpTypID + '>' + item.EmpTypName + '</option>').selectpicker('refresh');;
            });
        });
    }

    function GetFundTypes() {

        var ddlBox = $("#FundType");

        $.ajax({
            url: "/Candidate/GetFundTypes",
            async: false
        }).done(function (data) {

            ddlBox.empty();
            ddlBox.append('<option value="0">--Select--</option>').selectpicker('refresh');
            $.each(data, function (i, item) {

                ddlBox.append('<option value=' + item.FundTypeID + '>' + item.FundType + '</option>').selectpicker('refresh');
            });

        });
    }

</script>

<section class="content-header">
       
    <ol class="breadcrumb">
        <li><a href="/Candidate/Index"><i class="fa fa-arrow-left"></i>&nbsp;&nbsp;Back &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</a></li>
    </ol>

</section>

<div class="padding-20" id="PrintDiv">  
    <div class="box box-primary">
        <div class="box-header text-center with-border">
            <h3 class="m-t-5"><i class="fa fa-envelope"></i>&nbsp;&nbsp;Appointment Letter</h3>
        </div> 
        <div class="box-body padding-20">
            <div class="text-right">
                <label>Date : @DateTime.Now.ToString("dd-MM-yyyy")</label>
            </div>
            <section class="padding-30">
                <h4><b>SECTION 1</b> GENERAL INFORMATION</h4>
                <hr class="divider">
                <input type="hidden" value="@ViewBag.candID" id="HidCandids" name="CandID" />
                <form class="form-horizontal" id="AppoinmentFormID">
                    
                    <div class="form-group">
                        <label class="col-sm-2 text-left padding-0 control-label">Name</label>
                        <div class="col-sm-8 print-col-8">
                            <span>@Model.CandName</span>
                        </div>
                    </div>
                    <div class="form-group">
                        <label class="col-sm-2 text-left padding-0 control-label">Job Title</label>
                        <div class="col-sm-8">
                            <span>@Model.DesigName</span>
                        </div>
                    </div>
                    @*<div class="form-group">
                        <label class="col-sm-2 text-left padding-0 control-label">Type of employment</label>
                        <div class="col-sm-8">
                            <span>Fulltime</span>
                        </div>
                    </div>*@
                    <div class="form-group">
                        <label class="col-sm-2 text-left padding-0 control-label">Employee NRIC/FIN</label>
                        <div class="col-sm-8">
                            <span>@Model.CandNRICNo</span>
                        </div>
                    </div>
                    <div class="form-group">
                        <label class="col-sm-2 text-left padding-0 control-label">Employee Address</label>
                        <div class="col-sm-8">
                            <span>@Model.CandAddress</span>
                        </div>
                    </div>
                    <div class="form-group">
                        <label class="col-sm-2 text-left padding-0 control-label">Employment Type</label>
                        <div class="col-sm-8">
                            <span>@*<select class="form-control required" name="Employeetyp" id="EmpTypID"></select>*@
                                @EmpDetail.EmpTypName
                            </span>
                        </div>
                    </div>
                    <div class="form-group">
                        <label class="col-sm-2 text-left padding-0 control-label">Employment Start date</label>
                        <div class="col-sm-8">
                            <span>@EmpDetail.EmpStartDate.ToString("dd/MM/yyyy")</span>
                        </div>
                    </div>
                    <div class="form-group" id="EmpEndDateDiv">
                        <label class="col-sm-2 text-left padding-0 control-label">Employment End date</label>
                        <div class="col-sm-8">
                            <span>@EmpDetail.EmpEndDate.ToString("dd/MM/yyyy")</span>
                        </div>
                    </div>
                    @*<div class="form-group" id="DivPartemp">
                        <label class="col-sm-2 control-label">Pay Structure</label>
                        <div class="col-sm-4">
                            <div class="input-group date">
                                <input type="radio" id="rd_PayStruct1" class="rd_PayStruct" name="EmpPartTime_Pay" value=1 />Hourly Rate
                                <input type="radio" id="rd_PayStruct2" class="rd_PayStruct" name="EmpPartTime_Pay" value=2 />Daily Rate
                            </div>
                        </div>
                    </div>*@
                    <div class="form-group">
                        <label class="col-sm-2 text-left padding-0 control-label" id="BSal">Basic Salary</label>
                        <label class="col-sm-2 control-label" id="BSal_PermanentEmp"></label>
                        <div class="col-sm-8">
                            <span>@ViewBag.BasicSal</span>
                        </div>
                    </div>                  
                    <!-- -->
                    <input type="hidden" value="@Model.CizenID" id="CizenID" />
                    @*<div id="div_funds">
                        <div class="form-group">
                            <label class="col-sm-2 text-left padding-0 control-label">CPF Contribution</label>
                            <div class="col-sm-8">
                                <label><input type="radio" name="CPF" value="1"> Yes</label>
                                <label><input type="radio" name="CPF" value="0"> No</label>
                            </div>
                        </div>
                        <div class="form-group">
                            <label class="col-sm-2 text-left padding-0 control-label">Other Fund Types</label>
                            <div class="col-sm-8">
                                <span><select class="form-control required" name="FundType" id="FundType" ></select></span>
                            </div>
                        </div>
                    </div>
                    <div class="form-group" id="div_levy">
                        <label class="col-sm-2 text-left padding-0 control-label">Levy</label>
                        <div class="col-sm-8">
                            <input type="text" id="Levy" class="form-control required" name="Levy" placeholder="Levy" autocomplete="off"/>
                        </div>
                    </div>*@
                    <!-- -->
                </form>
                <section class="m-t-30">
                    <h4><b>SECTION 2</b> WORKING HOURS AND REST DAYS</h4>
                    <hr class="divider">
                    <table class="table table-condenced">
                        <thead>
                            <tr>
                                <th colspan="3">Working Hours and Total Hours</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>06 Days a Week</td>
                                <td>8 hours per day</td>
                            </tr>
                            <tr>
                                <td>Rest Day</td>
                                <td>To be advise</td>
                            </tr>
                            <tr>
                                <td>Lunch Time</td>
                                <td>1 Hours</td>
                            </tr>
                            <tr>
                                <td>Tea Break 1</td>
                                <td>15 minutes</td>
                            </tr>
                            <tr>
                                <td>Tea Break 2</td>
                                <td>15 minutes</td>
                            </tr>
                        </tbody>
                        <tfoot>
                            <tr>
                                <td colspan="3" class="text-right">
                                    <i>Total working hours per week : 44<i>
                                </td>
                            </tr>
                        </tfoot>
                    </table>
                </section>
                <section class="m-t-30">
                    <h4><b>SECTION 3</b> SALARY</h4>
                    <hr class="divider">
                    <div class="well">
                        <div class="row">
                            <div class="col-sm-6 print-col-6">
                                <h5>Basic Salary</h5>
                                <div class="form-horizontal">
                                    @*<div class="form-group">
                                        <label class="col-sm-3 print-col-3 text-left padding-0 control-label">Amount</label>
                                        <div class="col-sm-7 print-col-7">
                                            <span>$12000</span>
                                        </div>
                                    </div>*@
                                    <div class="form-group">
                                        <label class="col-sm-3 text-left padding-0 control-label">Payment Date</label>
                                        <div class="col-sm-7">
                                            <span>7th of each month</span>
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <label class="col-sm-3 text-left padding-0 control-label">Salary Period</label>
                                        <div class="col-sm-7">
                                            <span>1st to 30th/31st</span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            @*<div class="col-sm-6 print-col-6">
                                <h5>Overtime Salary</h5>
                                <div class="form-horizontal">
                                    <div class="form-group">
                                        <label class="col-sm-3 text-left padding-0 control-label">Rate</label>
                                        <div class="col-sm-7">
                                            <span>$12000</span>
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <label class="col-sm-3 text-left padding-0 control-label">Payment Date</label>
                                        <div class="col-sm-7">
                                            <span>7th of each month</span>
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <label class="col-sm-3 text-left padding-0 control-label">Salary Period</label>
                                        <div class="col-sm-7">
                                            <span>1st to 30th/31st</span>
                                        </div>
                                    </div>
                                </div>
                            </div>*@
                        </div>
                    </div>
                    <div class="form-group">
                        <label class="col-sm-2 text-left padding-0 control-label">Payment Frequency</label>
                        <div class="col-sm-8">
                            <span>Monthly</span>
                        </div>
                    </div>
                    <div class="clearfix"></div>
                    <div class="row m-t-15">
                        <div class="col-sm-6">
                            <h5>Fixed Allowence Per Salary Period</h5>
                            <div class="form-horizontal">
                                <div class="form-group">
                                    <label class="col-sm-3 print-col-3 text-left padding-0 control-label">1. Transport</label>
                                    <div class="col-sm-7 print-col-7">
                                        <span>$250</span>
                                    </div>
                                </div>
                                <div class="form-group">
                                    <label class="col-sm-3 text-left padding-0 control-label">2. Food</label>
                                    <div class="col-sm-7">
                                        <span>$100</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col-sm-6">
                            <h5>Non-Fixed Salary Related Components</h5>
                            <div class="form-horizontal">
                                <div class="form-group">
                                    <label class="col-sm-3 text-left padding-0 control-label">1. 100% Attendance</label>
                                    <div class="col-sm-7">
                                        <span>$100</span>
                                    </div>
                                </div>
                                <div class="form-group">
                                    <label class="col-sm-3 text-left padding-0 control-label">2. 100% Clocking</label>
                                    <div class="col-sm-7">
                                        <span>$200</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>                    
                    <hr class="divider">
                    <h5><b>1. Salary Date</b></h5>
                    <p>If 7th or 25th falls on a Sunday or Monday, your salary will be credited into your account on Tuesday.</p>
                    <h5><b>2. Advance Payment</b></h5>
                    <p>If you are entitled for advance salary, you will receive on the 25th of the current month an advance payment of between S$200.00 to S$400.00.</p>
                    <h5><b>3. Rest Day</b></h5>
                    <p>
                        Any work on Rest Day will be by agreement between the parties from time to time.
                        <ul>
                            <li>If you work on a Sunday/Rest Day at the request of DRAGNET, you will be paid one day's basic salary for working up to half the normal daily working hours or two day's basic salary for working more than half the normal daily working hours.</li>
                            <li>If you work beyond your normal daily working hours on your Rest Day, you shall be paid 1.5 times of your hourly basic rate of pay.</li>
                            <li>If you work on a Rest Day at your own request, you will be paid half day's basic salary for work up to half the normal daily working hours or one day's basic salary for working more than half the normal daily working hours.  </li>
                        </ul>
                    </p>
                </section>
            </section>
        </div> 
    </div>
</div>
    <div class="box-footer text-right">
        <button type="button" class="btn btn-default " id="PrintApponmentLetter"><i class="fa fa-print"></i> Print</button>
        <button type="button" class="btn btn-success " id="btnAddAppoinment">Save</button>
    </div>
 
