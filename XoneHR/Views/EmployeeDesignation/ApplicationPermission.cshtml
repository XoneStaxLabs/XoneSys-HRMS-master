@{
    ViewBag.Title = "ApplicationPermission";
}
<link href="~/jqwidgets/jqwidgets/styles/jqx.base.css" rel="stylesheet" />
<link href="~/jqwidgets/jqwidgets/styles/jqx.metro.css" rel="stylesheet" />
<script src="~/jqwidgets/jqwidgets/jqxcore.js"></script>
<script src="~/jqwidgets/jqwidgets/jqxdata.js"></script>
<script src="~/jqwidgets/jqwidgets/jqxbuttons.js"></script>
<script src="~/jqwidgets/jqwidgets/jqxscrollbar.js"></script>
<script src="~/jqwidgets/jqwidgets/jqxbuttons.js"></script>
<script src="~/jqwidgets/jqwidgets/jqxpanel.js"></script>
<script src="~/jqwidgets/jqwidgets/jqxtree.js"></script>
<script src="~/jqwidgets/jqwidgets/jqxcheckbox.js"></script>

<script src="~/plugins/Toast/src/jquery.toast.js"></script>
<link href="~/plugins/Toast/src/jquery.toast.css" rel="stylesheet" />

<script type="text/javascript">

    function GetMenuMasterData(Desig_ID)
    {
        $.ajax({
            type: "GET",
            url: "/EmployeeDesignation/GetjsonData",
            data: { DesigID: Desig_ID },
            async: false
        }).done(function (data) {
            $('#jqxTree').jqxTree('clear');
            var dataAdapter = new $.jqx.dataAdapter(data);
            dataAdapter.dataBind();
            var records = dataAdapter.getRecordsHierarchy('id', 'parentid', 'items', [{ name: 'text', map: 'label' }]);
            $('#jqxTree').jqxTree({ source: records, width: '300px', theme: 'metro' });
        });
    }

    $(document).ready(function () {


        // create jqxTree
        $('#jqxTree').jqxTree({ height: '400px', hasThreeStates: true, checkboxes: true, width: '330px' });
        $('#jqxTree').css('visibility', 'visible');

      
       GetMenuMasterData(0);

        $("#Btnsave").click(function () {           
           
                var items = $("#jqxTree").jqxTree('getItems');
                var checkedItems = new Array();
                $.each(items, function () {
                    if (this.checked == true || this.checked == null) {
                        checkedItems.push(this.id);
                    }
                });
                $.ajax({
                    type: "POST",
                    url: "/EmployeeDesignation/AllManageDesigPermission",
                    data: {
                        Data: JSON.stringify(checkedItems), DesigID: 0, DepID: $("#DepID").val(), DesigName: $("#DesigName").val(), usertype: $("#UserTyp").val()},
                    async: false
                }).done(function (data) {

                    $.toast({
                        text: data.Message,
                        position: 'top-right',
                        hideAfter: 2000,
                        showHideTransition: 'slide',
                        loader: false,
                    })
                    if (data.Result == 1) {
                        window.location.href = "/EmployeeDesignation/Index"
                    }

                })
            
        });
    })

</script>


    
    <section class="newforms">
        <div class="tabsnew">
            <div class="tab-content">
                <div role="tabpanel" class="tab-pane active" id="profile">
                    <form class="" action="#" id="frmDesigPermission">
                        <div class="row">
                            <div class="col-md-12">
                                <div class="col-md-6">
                                    <h3 class="box-title">Menu Permission</h3>
                                    <hr />
                                    <div id='jqxWidget'>
                                        <div style='float: left;'>
                                            <div id='jqxTree' style='visibility: hidden; float: left; margin-left: 20px;'>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="text-left">
                            <button type="button" class="btn btn-sm btn-success" id="Btnsave">Save<span>&nbsp;</span> <i class="fa fa-floppy-o"></i></button>
                        </div>

                    </form>
                </div>

            </div>
        </div>

</section>





